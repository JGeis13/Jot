"use strict";var unsubscribe=null;auth.onAuthStateChanged(function(a){console.log("auth state change"),a?(console.log(a),ui.setupUI(a),unsubscribe=db.collection("users").doc(a.uid).onSnapshot(function(a){ui.getAccountInfo(a.data().accountInfo),ui.buildTodos(a.data().todos),ui.buildCompletedTodos(a.data().completedTodos),ui.buildNotes(a.data().notes)},function(a){console.log(a.message)})):(console.log("no user logged in"),unsubscribe&&(unsubscribe(),console.log("unsubscribed"),unsubscribe=null),ui.setupUI(a))});var signUp_form=document.querySelector("#signup-form");signUp_form.addEventListener("submit",function(a){var b=signUp_form["signup-email"].value,c=signUp_form["signup-password"].value;a.preventDefault(),auth.createUserWithEmailAndPassword(b,c).then(function(a){return db.collection("users").doc(a.user.uid).set({todos:{},notes:{},completedTodos:{},accountInfo:{memberLevel:"free"}})}).then(function(){var a=document.getElementById("modal-signup");M.Modal.getInstance(a).close(),signUp_form.reset(),document.querySelector("#signup-error").innerText="",M.toast({html:"Welcome!"})})["catch"](function(a){document.querySelector("#signup-error").innerText=a.message,console.error(a.message)})});var login_form=document.querySelector("#login-form");login_form.addEventListener("submit",function(a){var b=login_form["login-email"].value,c=login_form["login-password"].value;a.preventDefault(),auth.signInWithEmailAndPassword(b,c).then(function(){var a=document.getElementById("modal-login");M.Modal.getInstance(a).close(),document.getElementById("login-error").textContent="",login_form.reset()})["catch"](function(a){document.getElementById("login-error").textContent=a.message,console.error(a.message)})});var googleSignIn_btn=document.querySelector(".modal .google-signin");googleSignIn_btn.addEventListener("click",googleSignIn);var googleSignUp_btn=document.querySelector(".modal .google-signup");googleSignUp_btn.addEventListener("click",googleSignIn);function googleSignIn(){var a=new firebase.auth.GoogleAuthProvider;a.addScope("profile"),a.addScope("email"),auth.signInWithPopup(a).then(function(a){return a.additionalUserInfo.isNewUser?db.collection("users").doc(a.user.uid).set({todos:{},notes:{},completedTodos:{},accountInfo:{memberLevel:"free"}}).then(function(a){console.log(a),M.toast({html:"Welcome!"})}):void M.toast({html:"Welcome back!"})}).then(function(){var a=document.getElementById("modal-signup");M.Modal.getInstance(a).close()})["catch"](function(a){console.error(a.message)})}document.getElementById("logout").addEventListener("click",function(){return auth.signOut()});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9qcy9hdXRoLmpzIl0sIm5hbWVzIjpbInVuc3Vic2NyaWJlIiwiYXV0aCIsIm9uQXV0aFN0YXRlQ2hhbmdlZCIsInVzZXIiLCJjb25zb2xlIiwibG9nIiwidWkiLCJzZXR1cFVJIiwiZGIiLCJjb2xsZWN0aW9uIiwiZG9jIiwidWlkIiwib25TbmFwc2hvdCIsImdldEFjY291bnRJbmZvIiwiZGF0YSIsImFjY291bnRJbmZvIiwiYnVpbGRUb2RvcyIsInRvZG9zIiwiYnVpbGRDb21wbGV0ZWRUb2RvcyIsImNvbXBsZXRlZFRvZG9zIiwiYnVpbGROb3RlcyIsIm5vdGVzIiwiZXJyb3IiLCJtZXNzYWdlIiwic2lnblVwX2Zvcm0iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImVtYWlsIiwidmFsdWUiLCJwYXNzd29yZCIsInByZXZlbnREZWZhdWx0IiwiY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkIiwidGhlbiIsImNyZWQiLCJzZXQiLCJtZW1iZXJMZXZlbCIsIm1vZGFsIiwiZ2V0RWxlbWVudEJ5SWQiLCJNIiwiTW9kYWwiLCJnZXRJbnN0YW5jZSIsImNsb3NlIiwicmVzZXQiLCJpbm5lclRleHQiLCJ0b2FzdCIsImh0bWwiLCJlcnIiLCJsb2dpbl9mb3JtIiwic2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQiLCJ0ZXh0Q29udGVudCIsImdvb2dsZVNpZ25Jbl9idG4iLCJnb29nbGVTaWduSW4iLCJnb29nbGVTaWduVXBfYnRuIiwicHJvdmlkZXIiLCJmaXJlYmFzZSIsIkdvb2dsZUF1dGhQcm92aWRlciIsImFkZFNjb3BlIiwic2lnbkluV2l0aFBvcHVwIiwiYWRkaXRpb25hbFVzZXJJbmZvIiwiaXNOZXdVc2VyIiwicmVzIiwic2lnbk91dCJdLCJtYXBwaW5ncyI6ImFBRUEsR0FBSUEsQ0FBQUEsV0FBVyxDQUFHLElBQWxCLENBRUFDLElBQUksQ0FBQ0Msa0JBQUwsQ0FBeUIsU0FB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SyxDQUFHYixRQUFRLENBQUNjLGNBQVQsQ0FBd0IsY0FBeEIsQ0FBZCxDQUNBQyxDQUFDLENBQUNDLEtBQUYsQ0FBUUMsV0FBUixDQUFvQkosQ0FBcEIsRUFBMkJLLEtBQTNCLEVBQ0QsQ0F4QkQsV0F5QlEsU0FBQUssQ0FBRyxDQUFJLENBQ2I1QyxPQUFPLENBQUNrQixLQUFSLENBQWUwQixDQUFHLENBQUN6QixPQUFuQixDQUNELENBM0JELENBNEJELENBR0RFLFFBQVEsQ0FBQ2MsY0FBVCxDQUF3QixRQUF4QixFQUFrQ1osZ0JBQWxDLENBQW1ELE9BQW5ELENBQTRELGlCQUFNMUIsQ0FBQUEsSUFBSSxDQUFDOEQsT0FBTCxFQUFOLENBQTVELEMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vIGxpc3RlbiBmb3IgYXV0aCBzdGF0dXMgY2hhbmdlc1xubGV0IHVuc3Vic2NyaWJlID0gbnVsbFxuXG5hdXRoLm9uQXV0aFN0YXRlQ2hhbmdlZCggdXNlciA9PiB7XG4gIGNvbnNvbGUubG9nKCBcImF1dGggc3RhdGUgY2hhbmdlXCIpXG4gIGlmKCB1c2VyICl7XG4gICAgY29uc29sZS5sb2codXNlcilcbiAgICB1aS5zZXR1cFVJKHVzZXIpXG5cbiAgICAvLyBsaXN0ZW5lciB0byBmaXJlIHdoZW5ldmVyIGNoYW5nZSBpcyBtYWRlIHRvIGRvY3VtZW50XG4gICAgLy8gcmV0dXJucyBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdW5zdWJzY3JpYmluZ1xuICAgIHVuc3Vic2NyaWJlID0gZGIuY29sbGVjdGlvbigndXNlcnMnKS5kb2ModXNlci51aWQpLm9uU25hcHNob3QoIGRvYyA9PiB7XG4gICAgICB1aS5nZXRBY2NvdW50SW5mbyhkb2MuZGF0YSgpLmFjY291bnRJbmZvKVxuICAgICAgdWkuYnVpbGRUb2Rvcyhkb2MuZGF0YSgpLnRvZG9zKVxuICAgICAgdWkuYnVpbGRDb21wbGV0ZWRUb2Rvcyhkb2MuZGF0YSgpLmNvbXBsZXRlZFRvZG9zKVxuICAgICAgdWkuYnVpbGROb3Rlcyhkb2MuZGF0YSgpLm5vdGVzKVxuICAgIH0sIGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCAgZXJyb3IubWVzc2FnZSApXG5cbiAgICB9KVxuICB9XG4gIGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKCdubyB1c2VyIGxvZ2dlZCBpbicpXG4gICAgaWYoIHVuc3Vic2NyaWJlICkgeyBcbiAgICAgIHVuc3Vic2NyaWJlKCkgXG4gICAgICBjb25zb2xlLmxvZygndW5zdWJzY3JpYmVkJylcbiAgICAgIHVuc3Vic2NyaWJlID0gbnVsbFxuICAgIH1cbiAgICB1aS5zZXR1cFVJKHVzZXIpXG4gIH1cbn0pXG5cbi8qIFNpZ24gVXAgd2l0aCBlbWFpbCBhbmQgcGFzc3dvcmQgKi9cbmNvbnN0IHNpZ25VcF9mb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NpZ251cC1mb3JtJylcbnNpZ25VcF9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoICdzdWJtaXQnLCAoZSkgPT4ge1xuICBjb25zdCBlbWFpbCA9IHNpZ25VcF9mb3JtWydzaWdudXAtZW1haWwnXS52YWx1ZVxuICBjb25zdCBwYXNzd29yZCA9IHNpZ25VcF9mb3JtWydzaWdudXAtcGFzc3dvcmQnXS52YWx1ZVxuICBlLnByZXZlbnREZWZhdWx0KClcbiAgYXV0aC5jcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQoZW1haWwsIHBhc3N3b3JkKVxuICAgIC50aGVuKCBjcmVkID0+IHtcbiAgICAgIC8vIGNyZWF0ZSB1c2VyIGRvYyBcbiAgICAgIHJldHVybiBkYi5jb2xsZWN0aW9uKCd1c2VycycpLmRvYyhjcmVkLnVzZXIudWlkKS5zZXQoe1xuICAgICAgICB0b2Rvczoge30sXG4gICAgICAgIG5vdGVzOiB7fSxcbiAgICAgICAgY29tcGxldGVkVG9kb3M6IHt9LFxuICAgICAgICBhY2NvdW50SW5mbzogeyBtZW1iZXJMZXZlbDogJ2ZyZWUnfVxuICAgICAgfSlcbiAgICB9KS50aGVuKCAoKSA9PiB7XG4gICAgICAvLyBjbG9zZSBtb2RhbFxuICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtc2lnbnVwJylcbiAgICAgIE0uTW9kYWwuZ2V0SW5zdGFuY2UobW9kYWwpLmNsb3NlKClcbiAgICAgIHNpZ25VcF9mb3JtLnJlc2V0KClcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzaWdudXAtZXJyb3InKS5pbm5lclRleHQgPSAnJ1xuICAgICAgTS50b2FzdCh7aHRtbDogJ1dlbGNvbWUhJ30pXG4gICAgfSlcbiAgICAuY2F0Y2goIGVyciA9PiB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2lnbnVwLWVycm9yJykuaW5uZXJUZXh0ID0gZXJyLm1lc3NhZ2VcbiAgICAgIGNvbnNvbGUuZXJyb3IoIGVyci5tZXNzYWdlIClcbiAgICB9KVxufSlcblxuLyogTG9naW4gd2l0aCBlbWFpbCBhbmQgcGFzc3dvcmQgKi9cbmNvbnN0IGxvZ2luX2Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbG9naW4tZm9ybScpXG5sb2dpbl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoICdzdWJtaXQnLCAoZSkgPT4ge1xuICBjb25zdCBlbWFpbCA9IGxvZ2luX2Zvcm1bJ2xvZ2luLWVtYWlsJ10udmFsdWVcbiAgY29uc3QgcGFzc3dvcmQgPSBsb2dpbl9mb3JtWydsb2dpbi1wYXNzd29yZCddLnZhbHVlXG4gIGUucHJldmVudERlZmF1bHQoKVxuICBhdXRoLnNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZClcbiAgICAudGhlbiggKCkgPT4ge1xuICAgICAgLy8gY2xvc2UgbW9kYWxcbiAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsLWxvZ2luJylcbiAgICAgIE0uTW9kYWwuZ2V0SW5zdGFuY2UobW9kYWwpLmNsb3NlKClcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbi1lcnJvcicpLnRleHRDb250ZW50ID0gJydcbiAgICAgIGxvZ2luX2Zvcm0ucmVzZXQoKVxuICAgIH0pXG4gICAgLmNhdGNoKCBlcnIgPT4ge1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luLWVycm9yJykudGV4dENvbnRlbnQgPSBlcnIubWVzc2FnZVxuICAgICAgY29uc29sZS5lcnJvciggZXJyLm1lc3NhZ2UgKVxuICAgIH0pXG59KVxuXG4vKiBTaWduIGluIHVzaW5nIEdvb2dsZSAqL1xuY29uc3QgZ29vZ2xlU2lnbkluX2J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbCAuZ29vZ2xlLXNpZ25pbicpXG5nb29nbGVTaWduSW5fYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZ29vZ2xlU2lnbkluKVxuXG5cbi8qIFNpZ24gdXAgdXNpbmcgR29vZ2xlICovXG5jb25zdCBnb29nbGVTaWduVXBfYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsIC5nb29nbGUtc2lnbnVwJylcbmdvb2dsZVNpZ25VcF9idG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBnb29nbGVTaWduSW4pXG5cbmZ1bmN0aW9uIGdvb2dsZVNpZ25Jbigpe1xuICAvLyBVc2luZyBhIHBvcHVwLlxuICB2YXIgcHJvdmlkZXIgPSBuZXcgZmlyZWJhc2UuYXV0aC5Hb29nbGVBdXRoUHJvdmlkZXIoKTtcbiAgcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAgcHJvdmlkZXIuYWRkU2NvcGUoJ2VtYWlsJyk7XG4gIGF1dGguc2lnbkluV2l0aFBvcHVwKHByb3ZpZGVyKVxuICAgIC50aGVuKCBjcmVkID0+IHtcbiAgICAgIC8vIElmIGl0J3MgYSBmaXJzdCB0aW1lIHVzZXIsIGNyZWF0ZSB0aGVpciBkb2N1bWVudCBpbiB1c2VycyBjb2xsZWN0aW9uXG4gICAgICAvLyAgIENvdWxkIHJlLWRpcmVjdCBpZiB1c2VyIHRoaW5rcyB0aGV5IGFyZSBzaWduaW5nIGluIHdpdGhvdXQga25vd2luZyB0aGV5IGRvbid0IHlldCBoYXZlIGFuIGFjY291bnRcbiAgICAgIGlmKCBjcmVkLmFkZGl0aW9uYWxVc2VySW5mby5pc05ld1VzZXIgKXtcbiAgICAgICAgcmV0dXJuIGRiLmNvbGxlY3Rpb24oJ3VzZXJzJykuZG9jKGNyZWQudXNlci51aWQpLnNldCh7XG4gICAgICAgICAgdG9kb3M6IHt9LFxuICAgICAgICAgIG5vdGVzOiB7fSxcbiAgICAgICAgICBjb21wbGV0ZWRUb2Rvczoge30sXG4gICAgICAgICAgYWNjb3VudEluZm86IHsgbWVtYmVyTGV2ZWw6ICdmcmVlJ31cbiAgICAgICAgfSkudGhlbiggcmVzID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyggcmVzIClcbiAgICAgICAgICBNLnRvYXN0KHtodG1sOiAnV2VsY29tZSEnfSlcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBNLnRvYXN0KHtodG1sOiAnV2VsY29tZSBiYWNrISd9KVxuICAgICAgfVxuICAgICAgcmV0dXJuXG4gICAgfSlcbiAgICAudGhlbiggKCkgPT4ge1xuICAgIC8vIGNsb3NlIG1vZGFsXG4gICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtc2lnbnVwJylcbiAgICBNLk1vZGFsLmdldEluc3RhbmNlKG1vZGFsKS5jbG9zZSgpXG4gIH0pXG4gIC5jYXRjaCggZXJyID0+IHtcbiAgICBjb25zb2xlLmVycm9yKCBlcnIubWVzc2FnZSApXG4gIH0pXG59XG5cbi8qIFNpZ24gT3V0ICovXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb3V0JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBhdXRoLnNpZ25PdXQoKSApXG5cblxuIl19